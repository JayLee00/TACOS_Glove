%% MATLAB 코드: Excel 데이터 파일 불러오기 및 산점도 플롯

% -------------------------------------------------------------------------
% 1. 데이터 불러오기
% -------------------------------------------------------------------------
clear; close all; clc;

% *** 사용자 설정: Excel 파일 이름을 실제 파일명으로 변경하세요. ***
file_path = 'Encoder.Data.xlsx'; 
% 예시: data_all = readmatrix('C:\Users\User\Documents\Encoder_Data_All.xlsx');

try
    % Excel 파일의 모든 데이터를 행렬로 불러옵니다.
    % 파일은 첫 번째 열(A열)에 각도(X), 두 번째 열(B열)에 값(Y)을 포함해야 합니다.
    data_all = readmatrix(file_path);
    
catch ME
    disp('*** 오류: Excel 파일을 불러올 수 없습니다. 파일 경로와 이름을 확인하세요. ***');
    rethrow(ME);
end

% -------------------------------------------------------------------------
% 2. 데이터 분리
% -------------------------------------------------------------------------

% 첫 번째 열을 X축 데이터 (각도)로 지정
x_angle = data_all(:, 1);

% 두 번째 열을 Y축 데이터 (인코더 값)로 지정
y_value = data_all(:, 2);

% -------------------------------------------------------------------------
% 3. 그래프 플롯
% -------------------------------------------------------------------------

figure;

% plot 함수를 사용하여 산점도(Scatter Plot)를 그립니다.
% 'b.'는 파란색 점(dot) 마커를 의미합니다.
plot(x_angle, y_value, 'b.', 'MarkerSize', 10);

title('인코더 각도 대 값 플롯');
xlabel('각도 (Degrees)');
ylabel('인코더 값 (Value)');
grid on;

disp(' ');
disp('---------------------------------------------------------');
disp(['총 ' num2str(length(x_angle)) '개의 데이터 포인트가 플롯되었습니다.']);
disp('---------------------------------------------------------');